# Alibaba Sentinel 疑问记录

## 一句话介绍Alibaba Sentinel

面向分布式服务架构的流量控制组件

## 什么是流量控制

- ### 场景

  在某一时刻用户请求数量超过了系统处理能力，会导致系统不稳定或者崩溃

- ### 需求

  我们需要某些机制来对流量进行控制，从而保证系统的稳定性

- ### 解决方案

  以流量为切入点，从限流、流量整形、熔断降级、系统负载保护等多个维度来保证系统的稳定性

## Sentinel的核心概念：资源

- ### 场景

- ### 需求

- ### 解决方案

- ### 底层原理

  - #### UML类图

  - #### 设计思想

## Sentinel的概念：规则

```java
com.alibaba.csp.sentinel.slots.block.Rule
```

## 什么是消息削峰填谷

- ### 场景

- ### 需求

- ### 解决方案

## Sentinel底层如何实现消息削峰填谷

- ### 组件结构（类图）

- ### 代码流程（时序图）

- ### 设计模式及其思想（为什么这样设计）

## Sentinel底层如何实现集群流量控制

- ### 组件结构（类图）

- ### 代码流程（时序图）

- ### 设计模式及其思想（为什么这样设计）

## Sentinel底层如何实现实时熔断下游的不可用应用

与Hystrix通过线程池隔离机制来进行熔断不同，Sentinel通过对并发线程数量进行限制或通过响应时间对资源进行降级来减少不稳定资源对其它资源的影响

- ### 具体如何限制并发线程数量

  - #### 大致逻辑

    某个资源出现不稳定的情况下，例如响应时间变长，对资源的直接影响就是会造成线程数的逐步堆积。当线程数在特定资源上堆积到一定的数量之后，对该资源的新请求就会被拒绝。堆积的线程完成任务后才开始继续接收请求

  - #### 代码流程（时序图）

  - #### 类结构（UML图）

  - ### 涉及的设计模式及其思想（为什么这样设计）

- ### 具体如何通过响应时间对资源进行降级

  - #### 大致逻辑

    当依赖的资源出现响应时间过长后，所有对该资源的访问都会被直接拒绝，直到过了指定的时间窗口之后才重新恢复

  - #### 代码流程（时序图）

  - #### 类结构（UML图）

  - ### 涉及的设计模式及其思想（为什么这样设计）

## Sentinel底层如何实现设计其监控功能

- ### 组件结构（类图）

- ### 代码流程（时序图）

- ### 设计模式及其思想（为什么这样设计）

## Sentinel底层如何汇总集群的运行情况

- ### 组件结构（类图）

- ### 代码流程（时序图）

- ### 设计模式及其思想（为什么这样设计）

- ## 如何使用Sentinel的SPI机制进行扩展

## Sentinel底层如何实现其SPI机制的

- ### 组件结构（类图）

- ### 代码流程（时序图）

- ### 设计模式及其思想（为什么这样设计）

## Sentinel的SPI机制与Spring Boot以及Dubbo的对比

## 什么是线程数隔离

- ### 场景

- ### 需求

- ### 解决方案

- ## Sentinel底层如何实现线程数隔离

  - ### 组件结构（类图）

  - ### 代码流程（时序图）

  - ### 设计模式及其思想（为什么这样设计）

## 什么是慢调用降级

- ### 场景

- ### 需求

- ### 解决方案

## Sentinel底层如何实现慢调用降级

- ### 组件结构（类图）

- ### 代码流程（时序图）

- ### 设计模式及其思想（为什么这样设计）

## Sentinel底层如何设计其调用链路

- ### 组件结构（类图）

- ### 代码流程（时序图）

- ### 设计模式及其思想（为什么这样设计）

## Sentinel底层如何实现速率控制

- ### 组件结构（类图）

- ### 代码流程（时序图）

- ### 设计模式及其思想（为什么这样设计）

## Sentinel中的系统自适应保护机制是什么样的

- ### 场景

  防止雪崩，是系统防护中重要的一环。当系统负载较高的时候，如果还持续让请求进入，可能会导致系统崩溃，无法响应。在集群环境下，网络负载均衡会把本应这台机器承载的流量转发到其它的机器上去。如果这个时候其它的机器也处在一个边缘状态的时候，这个增加的流量就会导致这台机器也崩溃，最后导致整个集群不可用

- ### 需求

- ### 解决方案

  针对这个情况，Sentinel 提供了对应的保护机制，让系统的入口流量和系统的负载达到一个平衡，保证系统在能力范围之内处理最多的请求

- ### 底层原理

  - #### 组件结构（类图）

  - #### 代码流程（时序图）

  - #### 设计模式及其思想（为什么这样设计）

## Sentinel中的调用关系限流？

- ### 场景

- ### 需求

- ### 解决方案

## Sentinel底层如何实现调用关系限流

- ### 组件结构（类图）

- ### 代码流程（时序图）

- ### 设计模式及其思想（为什么这样设计）

## 什么是热点限流？

- ### 场景

- ### 需求

- ### 解决方案

## 热点限流与调用关系限流有什么不同

## Sentinel底层如何实现热点限流

- ### 组件结构（类图）

- ### 代码流程（时序图）

- ### 设计模式及其思想（为什么这样设计）

